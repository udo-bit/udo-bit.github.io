import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,o as a,d as e}from"./app-C5AwaB9N.js";const i={},l=e(`<p>在shell脚本编写中，时常会用到对文件的相关操作，比如增加内容，修改内容，删除部分内容，查看部分内容等，但是上述举例的这些操作一般都是需要在文本编辑器中才能操作，常用的文本编辑器如：gedit、vim、nano等又是交互式文本编辑器，脚本无法自己独立完成，必须有人参与才可以完成。如果这样的话又违背了我们编写脚本的意愿( 全部由机器来完成，减少人的工作压力，提升工作效率)。emm…如何才能让这些操作全部脚本自己就搞定，而不需要人的参与，而且又能按照我们的脚本预案来完成呢？</p><p>为了解决上述问题，linux为大家提供了一些命令,比如Perl、sed等命令，今天我就着重为大家介绍一下sed命令。</p><h2 id="一、sed介绍" tabindex="-1"><a class="header-anchor" href="#一、sed介绍"><span>一、sed介绍</span></a></h2><p>sed是linux中提供的一个外部命令,它是一个行(流)编辑器，非交互式的对文件内容进行增删改查的操作，使用者只能在命令行输入编辑命令、指定文件名，然后在屏幕上查看输出。它和文本编辑器有本质的区别。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>区别是：</span></span>
<span class="line"><span></span></span>
<span class="line"><span>文本编辑器: 编辑对象是文件</span></span>
<span class="line"><span></span></span>
<span class="line"><span>行编辑器：编辑对象是文件中的行</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>也就是前者一次处理一个文本，而后者是一次处理一个文本中的一行。这个是我们应该弄清楚且必须牢记的，否者可能无法理解sed的运行原理和使用精髓。</p><p><strong>sed数据处理原理</strong></p><figure><img src="https://www.zutuanxue.com:8000/static/media/images/2020/10/6/1601961286169.png" alt="sed处理数据原理.png" tabindex="0" loading="lazy"><figcaption>sed处理数据原理.png</figcaption></figure><h2 id="二、sed语法" tabindex="-1"><a class="header-anchor" href="#二、sed语法"><span>二、sed语法</span></a></h2><p><strong>sed 命令语法：</strong></p><p>sed [options] ‘{command}[flags]’ [filename]</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>#命令选项</span></span>
<span class="line"><span>-e script 将脚本中指定的命令添加到处理输入时执行的命令中  多条件，一行中要有多个操作</span></span>
<span class="line"><span>-f script 将文件中指定的命令添加到处理输入时执行的命令中</span></span>
<span class="line"><span>-n        抑制自动输出</span></span>
<span class="line"><span>-i        编辑文件内容</span></span>
<span class="line"><span>-i.bak    修改时同时创建.bak备份文件。</span></span>
<span class="line"><span>-r        使用扩展的正则表达式</span></span>
<span class="line"><span>!         取反 （跟在模式条件后与shell有所区别）</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#command   对文件干什么</span></span>
<span class="line"><span>sed常用内部命令</span></span>
<span class="line"><span>a   在匹配后面添加</span></span>
<span class="line"><span>i   在匹配前面添加</span></span>
<span class="line"><span></span></span>
<span class="line"><span>d   删除</span></span>
<span class="line"><span></span></span>
<span class="line"><span>s   查找替换  字符串</span></span>
<span class="line"><span>c   更改</span></span>
<span class="line"><span>y   转换   N D P </span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>p   打印</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>#flags</span></span>
<span class="line"><span>数字             表示新文本替换的模式</span></span>
<span class="line"><span>g：             表示用新文本替换现有文本的全部实例</span></span>
<span class="line"><span>p：             表示打印原始的内容</span></span>
<span class="line"><span>w filename:     将替换的结果写入文件</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-1-sed内部命令说明" tabindex="-1"><a class="header-anchor" href="#_2-1-sed内部命令说明"><span>2.1）sed内部命令说明</span></a></h3><p><strong>演示实例文档</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>[root@zutuanxue ~]# cat data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>文件内容增加操作,将数据追加到某个位置之后，使用命令a。</p><p><strong>演示案例</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>在data1的每行后追加一行新数据内容: append data &quot;haha&quot;</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;a\\append data &quot;haha&quot;&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>append data &quot;haha&quot;</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>append data &quot;haha&quot;</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>append data &quot;haha&quot;</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>append data &quot;haha&quot;</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>append data &quot;haha&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>在第二行后新开一行追加数据: append data &quot;haha&quot;</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;2a\\append data &quot;haha&quot;&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>append data &quot;haha&quot;</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>在第二到四行每行后新开一行追加数据: append data &quot;haha&quot;</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;2,4a\\append data &quot;haha&quot;&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>append data &quot;haha&quot;</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>append data &quot;haha&quot;</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>append data &quot;haha&quot;</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>匹配字符串追加: 找到包含&quot;3 the&quot;的行，在其后新开一行追加内容: append data &quot;haha&quot;</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;/3 the/a\\append data &quot;haha&quot;&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>append data &quot;haha&quot;</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//开启匹配模式  /要匹配的字符串/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>文件内容增加操作,将数据插入到某个位置之前，使用命令i。</p><p><strong>演示案例</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>在data1的每行前插入一行新数据内容: insert data &quot;haha&quot;</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;i\\insert data &quot;haha&quot;&#39; data1</span></span>
<span class="line"><span>insert data &quot;haha&quot;</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>insert data &quot;haha&quot;</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>insert data &quot;haha&quot;</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>insert data &quot;haha&quot;</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>insert data &quot;haha&quot;</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>在第二行前新开一行插入数据: insert data &quot;haha&quot;</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;2i\\insert data &quot;haha&quot;&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>insert data &quot;haha&quot;</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>在第二到四行每行前新开一行插入数据: insert data &quot;haha&quot;</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;2,4i\\insert data &quot;haha&quot;&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>insert data &quot;haha&quot;</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>insert data &quot;haha&quot;</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>insert data &quot;haha&quot;</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>匹配字符串插入: 找到包含&quot;3 the&quot;的行，在其前新开一行插入内容: insert data &quot;haha&quot;</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;/3 the/i\\insert data &quot;haha&quot;&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>insert data &quot;haha&quot;</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>文件内容修改操作–替换,将一行中匹配的内容替换为新的数据，使用命令s。</p><p><strong>演示案例</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>从标准输出流中做替换，将test替换为text</span></span>
<span class="line"><span>[root@zutuanxue ~]# echo &quot;this is a test&quot; |sed &#39;s/test/text/&#39;</span></span>
<span class="line"><span>this is a text</span></span>
<span class="line"><span></span></span>
<span class="line"><span>将data1中每行的dog替换为cat</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;s/dog/cat/&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy cat.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy cat.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy cat.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy cat.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy cat.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>将data1中第二行的dog替换为cat</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;2s/dog/cat/&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy cat.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>将data1中第二到第四行的dog替换为cat</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;2,4s/dog/cat/&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy cat.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy cat.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy cat.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>匹配字符串替换:将包含字符串&quot;3 the&quot;的行中的dog替换为cat</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;/3 the/s/dog/cat/&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy cat.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>文件内容修改操作–更改,将一行中匹配的内容替换为新的数据，使用命令c。</p><p><strong>演示案例</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>将data1文件中的所有行的内容更改为: change data &quot;data&quot;</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;c\\change data &quot;haha&quot;&#39; data1</span></span>
<span class="line"><span>change data &quot;haha&quot;</span></span>
<span class="line"><span>change data &quot;haha&quot;</span></span>
<span class="line"><span>change data &quot;haha&quot;</span></span>
<span class="line"><span>change data &quot;haha&quot;</span></span>
<span class="line"><span>change data &quot;haha&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>将data1文件第二行的内容更改为: change data &quot;haha&quot;</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;2c\\change data &quot;haha&quot;&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>change data &quot;haha&quot;</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>将data1文件中的第二、三、四行的内容更改为：change data &quot;haha&quot;</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;2,4c\\change data &quot;haha&quot;&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>change data &quot;haha&quot;</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>将data1文件中包含&quot;3 the&quot;的行内容更改为: change data &quot;haha&quot;</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;/3 the/c\\change data &quot;data&quot;&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>change data &quot;data&quot;</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>文件内容修改操作–字符转换，将一行中匹配的内容替换为新的数据，使用命令y。</p><p><strong>演示案例</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>将data1中的a b c字符转换为对应的 A  B  C字符</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;y/abc/ABC/&#39; data1</span></span>
<span class="line"><span>1 the quiCk Brown fox jumps over the lAzy dog.</span></span>
<span class="line"><span>2 the quiCk Brown fox jumps over the lAzy dog.</span></span>
<span class="line"><span>3 the quiCk Brown fox jumps over the lAzy dog.</span></span>
<span class="line"><span>4 the quiCk Brown fox jumps over the lAzy dog.</span></span>
<span class="line"><span>5 the quiCk Brown fox jumps over the lAzy dog.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>文件内容删除，将文件中的指定数据删除，使用命令d。</p><p><strong>演示案例</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>删除文件data1中的所有数据</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;d&#39; data1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>删除文件data1中的第三行数据</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;3d&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>删除文件data1第三到第四行的数据</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;3,4d&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>删除文件data1中包含字符串&quot;3 the&quot;的行</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;/3 the/d&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>文件内容查看，将文件内容输出到屏幕，使用命令p。</p><p><strong>演示案例</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>打印data1文件内容</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;p&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>打印data1文件第三行的内容</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;3p&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>打印data1文件第二、三、四行内容</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;2,4p&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>打印data1文件包含字符串&quot;3 the&quot;的行</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;/3 the/p&#39; data1</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog. </span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>可以看得出，打印内容是重复的行，原因是打印了指定文件内容一次，又将读入缓存的所有数据打印了一次，所以会看到这样的效果，</span></span>
<span class="line"><span>如果不想看到这样的结果，可以加命令选项-n抑制内存输出即可。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-命令选项说明" tabindex="-1"><a class="header-anchor" href="#_2-2-命令选项说明"><span>2.2）命令选项说明</span></a></h3><p><strong>sed语法</strong><strong>在sed命令中，命令选项是对sed中的命令的增强</strong></p><p>在命令行中使用多个命令 -e</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>将brown替换为green dog替换为cat</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed -e &#39;s/brown/green/;s/dog/cat/&#39; data1</span></span>
<span class="line"><span>1 the quick green fox jumps over the lazy cat.</span></span>
<span class="line"><span>2 the quick green fox jumps over the lazy cat.</span></span>
<span class="line"><span>3 the quick green fox jumps over the lazy cat.</span></span>
<span class="line"><span>4 the quick green fox jumps over the lazy cat.</span></span>
<span class="line"><span>5 the quick green fox jumps over the lazy cat.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从文件读取编辑器命令 -f 适用于日常重复执行的场景</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>1）将命令写入文件</span></span>
<span class="line"><span>[root@zutuanxue ~]# vim abc</span></span>
<span class="line"><span>s/brown/green/</span></span>
<span class="line"><span>s/dog/cat/</span></span>
<span class="line"><span>s/fox/elephant/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2）使用-f命令选项调用命令文件</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed -f abc data1 </span></span>
<span class="line"><span>1 the quick green elephant jumps over the lazy cat.</span></span>
<span class="line"><span>2 the quick green elephant jumps over the lazy cat.</span></span>
<span class="line"><span>3 the quick green elephant jumps over the lazy cat.</span></span>
<span class="line"><span>4 the quick green elephant jumps over the lazy cat.</span></span>
<span class="line"><span>5 the quick green elephant jumps over the lazy cat.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>抑制内存输出 -n</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>打印data1文件的第二行到最后一行内容  $最后的意思</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed -n &#39;2,$p&#39; data1 </span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用正则表达式 -r</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>打印data1中以字符串&quot;3 the&quot;开头的行内容</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed -n  -r &#39;/^(3 the)/p&#39; data1</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从上述的演示中，大家可以看出，数据处理只是在缓存中完成的，并没有实际修改文件内容，如果需要修改文件内容可以直接使用-i命令选项。在这里我需要说明的是-i是一个不可逆的操作，一旦修改，如果想复原就很困难，几乎不可能，所以建议大家在操作的时候可以备份一下源文件。-i命令选项提供了备份功能，比如参数使用-i.bak，那么在修改源文件的同时会先备份一个以.bak结尾的源文件，然后再进行修改操作。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>1）查看文件列表，没有发现data1.bak</span></span>
<span class="line"><span>[root@zutuanxue ~]# ls</span></span>
<span class="line"><span>abc  apache  data1  Dobby  file  node-v10.14.1  Python-3.7.1  soft1  vimset</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2）执行替换命令并修改文件</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed -i.bak &#39;s/brown/green/&#39; data1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3）发现文件夹中多了一个data1.bak文件</span></span>
<span class="line"><span>[root@zutuanxue ~]# ls</span></span>
<span class="line"><span>abc     data1      Dobby  node-v10.14.1  soft1</span></span>
<span class="line"><span>apache  data1.bak  file   Python-3.7.1   vimset</span></span>
<span class="line"><span></span></span>
<span class="line"><span>4）打印比较一下，发现data1已经被修改，data1.bak是源文件的备份。</span></span>
<span class="line"><span>[root@zutuanxue ~]# cat data1</span></span>
<span class="line"><span>1 the quick green fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick green fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick green fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick green fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick green fox jumps over the lazy dog.</span></span>
<span class="line"><span>[root@zutuanxue ~]# cat data1.bak </span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog.</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-标志" tabindex="-1"><a class="header-anchor" href="#_2-3-标志"><span>2.3）标志</span></a></h3><p><strong>在sed命令中，标志是对sed中的内部命令做补充说明</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>演示文档</span></span>
<span class="line"><span>[root@zutuanxue ~]# cat data2</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog . dog</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog . dog</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog . dog</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog . dog</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog . dog</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>数字标志：此标志是一个非零正数，默认情况下，执行替换的时候，如果一行中有多个符合的字符串，如果没有标志位定义，那么只会替换第一个字符串，其他的就被忽略掉了，为了能精确替换，可以使用数字位做定义。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>替换一行中的第二处dog为cat</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;s/dog/cat/2&#39; data2</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog . cat</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog . cat</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy dog . cat</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog . cat</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog . cat</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>g标志:将一行中的所有符合的字符串全部执行替换</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>将data1文件中的所有dog替换为cat</span></span>
<span class="line"><span>[root@zutuanxue ~]# sed &#39;s/dog/cat/g&#39; data2</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy cat . cat</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy cat . cat</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy cat . cat</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy cat . cat</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy cat . cat</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>p标志：打印文本内容，类似于-p命令选项</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>[root@zutuanxue ~]# sed  &#39;3s/dog/cat/p&#39; data2</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog . dog</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog . dog</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy cat . dog</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy cat . dog</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog . dog</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog . dog</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>w filename标志:将修改的内容存入filename文件中</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>[root@zutuanxue ~]# sed  &#39;3s/dog/cat/w text&#39; data2</span></span>
<span class="line"><span>1 the quick brown fox jumps over the lazy dog . dog</span></span>
<span class="line"><span>2 the quick brown fox jumps over the lazy dog . dog</span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy cat . dog</span></span>
<span class="line"><span>4 the quick brown fox jumps over the lazy dog . dog</span></span>
<span class="line"><span>5 the quick brown fox jumps over the lazy dog . dog</span></span>
<span class="line"><span></span></span>
<span class="line"><span>可以看出，将修改的第三行内容存在了text文件中</span></span>
<span class="line"><span>[root@zutuanxue ~]# cat text </span></span>
<span class="line"><span>3 the quick brown fox jumps over the lazy cat . dog</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="三、练习案例" tabindex="-1"><a class="header-anchor" href="#三、练习案例"><span>三、练习案例</span></a></h2><p>3.1、写一个初始化系统的脚本 <strong>案例需求</strong> 1）自动修改主机名（如：ip是192.168.0.88，则主机名改为server88.zutuanxue.cc）</p><p>a. 更改文件非交互式 sed</p><p>/etc/sysconfig/network</p><p>b.将本主机的IP截取出来赋值给一个变量ip;再然后将ip变量里以.分割的最后一位赋值给另一个变量ip1</p><p>2）自动配置可用的yum源</p><p>3）自动关闭防火墙和selinux</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>1、关闭防火墙</span></span>
<span class="line"><span>2、关闭selinux</span></span>
<span class="line"><span>3、配置yum源</span></span>
<span class="line"><span>4、ntp时间服务器 </span></span>
<span class="line"><span>5、更新系统软件包</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>3.2、写一个搭建ftp服务的脚本，要求如下：</strong><strong>案例需求</strong> 1）不支持本地用户登录 local_enable=NO 2） 匿名用户可以上传 新建 删除 anon_upload_enable=YES anon_mkdir_write_enable=YES 3） 匿名用户限速500KBps anon_max_rate=500000</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>仅供参考：</span></span>
<span class="line"><span>#!/bin/bash</span></span>
<span class="line"><span>ipaddr=\`ifconfig eth0|sed -n &#39;2p&#39;|sed -e &#39;s/.*inet addr:\\(.*\\) Bcast.*/\\1/g&#39;\`</span></span>
<span class="line"><span>iptail=\`echo $ipaddr|cut -d&#39;.&#39; -f4\`</span></span>
<span class="line"><span>ipremote=192.168.1.10</span></span>
<span class="line"><span>#修改主机名</span></span>
<span class="line"><span>hostname server$iptail.zutuanxue.com</span></span>
<span class="line"><span>sed -i &quot;/HOSTNAME/cHOSTNAME=server$iptail.zutuanxue.com&quot; /etc/sysconfig/network</span></span>
<span class="line"><span>echo &quot;$ipaddr server$iptail.zutuanxue.cc&quot; &gt;&gt;/etc/hosts</span></span>
<span class="line"><span>#关闭防火墙和selinux</span></span>
<span class="line"><span>service iptables stop</span></span>
<span class="line"><span>setenforce 0 &gt;/dev/null 2&gt;&amp;1</span></span>
<span class="line"><span>sed -i &#39;/^SELINUX=/cSELINUX=disabled&#39; /etc/selinux/config</span></span>
<span class="line"><span>#配置yum源(一般是内网源)</span></span>
<span class="line"><span>#test network</span></span>
<span class="line"><span>ping -c 1 $ipremote &gt; /dev/null 2&gt;&amp;1</span></span>
<span class="line"><span>if [ $? -ne 0 ];then</span></span>
<span class="line"><span>	echo &quot;你的网络不通，请先检查你的网络&quot;</span></span>
<span class="line"><span>	exit 1</span></span>
<span class="line"><span>else</span></span>
<span class="line"><span>	echo &quot;网络ok.&quot;</span></span>
<span class="line"><span>fi</span></span>
<span class="line"><span>cat &gt; /etc/yum.repos.d/server.repo &lt;&lt; end</span></span>
<span class="line"><span>[server]</span></span>
<span class="line"><span>name=server</span></span>
<span class="line"><span>baseurl=ftp://$ipremote</span></span>
<span class="line"><span>enabled=1</span></span>
<span class="line"><span>gpgcheck=0</span></span>
<span class="line"><span>end</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#安装软件</span></span>
<span class="line"><span>read -p &quot;请输入需要安装的软件，多个用空格隔开：&quot; soft</span></span>
<span class="line"><span>yum -y install $soft &amp;&gt;/dev/null</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#备份配置文件</span></span>
<span class="line"><span>conf=/etc/vsftpd/vsftpd.conf</span></span>
<span class="line"><span>\\cp $conf $conf.default</span></span>
<span class="line"><span>#根据需求修改配置文件</span></span>
<span class="line"><span>sed -ir &#39;/^#|^$/d&#39; $conf</span></span>
<span class="line"><span>sed -i &#39;/local_enable/c\\local_enable=NO&#39; $conf</span></span>
<span class="line"><span>sed -i &#39;$a anon_upload_enable=YES&#39; $conf</span></span>
<span class="line"><span>sed -i &#39;$a anon_mkdir_write_enable=YES&#39; $conf</span></span>
<span class="line"><span>sed -i &#39;$a anon_other_write_enable=YES&#39; $conf</span></span>
<span class="line"><span>sed -i &#39;$a anon_max_rate=512000&#39; $conf</span></span>
<span class="line"><span>#启动服务</span></span>
<span class="line"><span>service vsftpd restart &amp;&gt;/dev/null &amp;&amp; echo&quot;vsftpd服务启动成功&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#测试验证</span></span>
<span class="line"><span>chmod 777 /var/ftp/pub</span></span>
<span class="line"><span>cp /etc/hosts /var/ftp/pub</span></span>
<span class="line"><span>#测试下载</span></span>
<span class="line"><span>cd /tmp</span></span>
<span class="line"><span>lftp $ipaddr &lt;&lt;end</span></span>
<span class="line"><span>cd pub</span></span>
<span class="line"><span>get hosts</span></span>
<span class="line"><span>exit</span></span>
<span class="line"><span>end</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if [ -f /tmp/hosts ];then</span></span>
<span class="line"><span>	echo &quot;匿名用户下载成功&quot;</span></span>
<span class="line"><span>	rm -f /tmp/hosts</span></span>
<span class="line"><span>else</span></span>
<span class="line"><span>	echo &quot;匿名用户下载失败&quot;</span></span>
<span class="line"><span>fi</span></span>
<span class="line"><span>#测试上传、创建目录、删除目录等</span></span>
<span class="line"><span>cd /tmp</span></span>
<span class="line"><span>lftp $ipaddr &lt;&lt; end</span></span>
<span class="line"><span>cd pub</span></span>
<span class="line"><span>mkdir test1</span></span>
<span class="line"><span>mkdir test2</span></span>
<span class="line"><span>put /etc/group</span></span>
<span class="line"><span>rmdir test2</span></span>
<span class="line"><span>exit</span></span>
<span class="line"><span>end</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if [ -d /var/ftp/pub/test1 ];then</span></span>
<span class="line"><span>    echo &quot;创建目录成功&quot;</span></span>
<span class="line"><span>	if [ ! -d /var/ftp/pub/test2 ];then</span></span>
<span class="line"><span>    	echo &quot;文件删除成功&quot;</span></span>
<span class="line"><span>        fi</span></span>
<span class="line"><span>else</span></span>
<span class="line"><span>	if [ -f /var/ftp/pub/group ];then</span></span>
<span class="line"><span>	echo &quot;文件上传成功&quot;</span></span>
<span class="line"><span>        else</span></span>
<span class="line"><span>        echo &quot;上传、创建目录删除目录部ok&quot;</span></span>
<span class="line"><span>        fi </span></span>
<span class="line"><span>fi   </span></span>
<span class="line"><span>[ -f /var/ftp/pub/group ] &amp;&amp; echo &quot;上传文件成功&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,69),p=[l];function d(c,t){return a(),n("div",null,p)}const u=s(i,[["render",d],["__file","shell对文件的操作.html.vue"]]),v=JSON.parse('{"path":"/demo/back-ends/Linux/Shell%E8%84%9A%E6%9C%AC/shell%E5%AF%B9%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C.html","title":"shell对文件的操作","lang":"en-US","frontmatter":{"title":"shell对文件的操作","icon":"code","category":"shell","order":22,"description":"在shell脚本编写中，时常会用到对文件的相关操作，比如增加内容，修改内容，删除部分内容，查看部分内容等，但是上述举例的这些操作一般都是需要在文本编辑器中才能操作，常用的文本编辑器如：gedit、vim、nano等又是交互式文本编辑器，脚本无法自己独立完成，必须有人参与才可以完成。如果这样的话又违背了我们编写脚本的意愿( 全部由机器来完成，减少人的工作...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/demo/back-ends/Linux/Shell%E8%84%9A%E6%9C%AC/shell%E5%AF%B9%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C.html"}],["meta",{"property":"og:site_name","content":"Utopia"}],["meta",{"property":"og:title","content":"shell对文件的操作"}],["meta",{"property":"og:description","content":"在shell脚本编写中，时常会用到对文件的相关操作，比如增加内容，修改内容，删除部分内容，查看部分内容等，但是上述举例的这些操作一般都是需要在文本编辑器中才能操作，常用的文本编辑器如：gedit、vim、nano等又是交互式文本编辑器，脚本无法自己独立完成，必须有人参与才可以完成。如果这样的话又违背了我们编写脚本的意愿( 全部由机器来完成，减少人的工作..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://www.zutuanxue.com:8000/static/media/images/2020/10/6/1601961286169.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-09-21T02:46:20.000Z"}],["meta",{"property":"article:author","content":"GXL"}],["meta",{"property":"article:modified_time","content":"2024-09-21T02:46:20.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"shell对文件的操作\\",\\"image\\":[\\"https://www.zutuanxue.com:8000/static/media/images/2020/10/6/1601961286169.png\\"],\\"dateModified\\":\\"2024-09-21T02:46:20.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"GXL\\",\\"url\\":\\"https://www.cnblogs.com/feel-myself\\",\\"email\\":\\"gaoxiaoliang123@126.com\\"}]}"]]},"headers":[{"level":2,"title":"一、sed介绍","slug":"一、sed介绍","link":"#一、sed介绍","children":[]},{"level":2,"title":"二、sed语法","slug":"二、sed语法","link":"#二、sed语法","children":[{"level":3,"title":"2.1）sed内部命令说明","slug":"_2-1-sed内部命令说明","link":"#_2-1-sed内部命令说明","children":[]},{"level":3,"title":"2.2）命令选项说明","slug":"_2-2-命令选项说明","link":"#_2-2-命令选项说明","children":[]},{"level":3,"title":"2.3）标志","slug":"_2-3-标志","link":"#_2-3-标志","children":[]}]},{"level":2,"title":"三、练习案例","slug":"三、练习案例","link":"#三、练习案例","children":[]}],"git":{"createdTime":1726886780000,"updatedTime":1726886780000,"contributors":[{"name":"udo-bit","email":"enote_gxl@163.com","commits":1}]},"readingTime":{"minutes":15.84,"words":4752},"filePathRelative":"demo/back-ends/Linux/Shell脚本/shell对文件的操作.md","localizedDate":"September 21, 2024","excerpt":"<p>在shell脚本编写中，时常会用到对文件的相关操作，比如增加内容，修改内容，删除部分内容，查看部分内容等，但是上述举例的这些操作一般都是需要在文本编辑器中才能操作，常用的文本编辑器如：gedit、vim、nano等又是交互式文本编辑器，脚本无法自己独立完成，必须有人参与才可以完成。如果这样的话又违背了我们编写脚本的意愿(\\n全部由机器来完成，减少人的工作压力，提升工作效率)。emm…如何才能让这些操作全部脚本自己就搞定，而不需要人的参与，而且又能按照我们的脚本预案来完成呢？</p>\\n<p>为了解决上述问题，linux为大家提供了一些命令,比如Perl、sed等命令，今天我就着重为大家介绍一下sed命令。</p>","autoDesc":true}');export{u as comp,v as data};
