import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,o as a,d as e}from"./app-B3Z58FXn.js";const i={},l=e(`<h2 id="案例需求" tabindex="-1"><a class="header-anchor" href="#案例需求"><span>案例需求</span></a></h2><p>URL监控脚本，对某个URL进行监控，返回值为200则代表成功访问。</p><h2 id="脚本应用场景" tabindex="-1"><a class="header-anchor" href="#脚本应用场景"><span>脚本应用场景：</span></a></h2><p>WEB站点监控</p><h2 id="解决问题" tabindex="-1"><a class="header-anchor" href="#解决问题"><span>解决问题</span></a></h2><p>URL监控</p><p>页面监控</p><h2 id="脚本思路" tabindex="-1"><a class="header-anchor" href="#脚本思路"><span>脚本思路</span></a></h2><p>1、使用curl访问一次URL，并将输出保存</p><p>2、访问输出文件，获取返回值</p><p>3、判断返回值是否和初始预设的返回值相等，并对应输出</p><h2 id="实现代码" tabindex="-1"><a class="header-anchor" href="#实现代码"><span>实现代码</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>#!/bin/bash</span></span>
<span class="line"><span># </span></span>
<span class="line"><span>#Author: www.zutuanxue.com</span></span>
<span class="line"><span>#Created Time: </span></span>
<span class="line"><span>#Release: </span></span>
<span class="line"><span>#Description: URL监控脚本</span></span>
<span class="line"><span>#监控阈值可以是: 状态码、页面字符串、页面所有内容</span></span>
<span class="line"><span>#本例以状态码为例</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#variables</span></span>
<span class="line"><span>init_url_status=200</span></span>
<span class="line"><span>temp_file=\`mktemp /tmp/check_url.XXX\`</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#help</span></span>
<span class="line"><span>if [ -z &quot;$1&quot; ]||[ &quot;$1&quot; == &quot;--help&quot; ];then</span></span>
<span class="line"><span>   echo &quot;$0 url&quot;</span></span>
<span class="line"><span>   echo &quot;--help: 打印该帮助&quot;</span></span>
<span class="line"><span>fi</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#如果用户没有传参则退出</span></span>
<span class="line"><span>[ $# -lt 1 ]&amp;&amp;exit 1</span></span>
<span class="line"><span>#main</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#1、使用curl命令访问一次URL</span></span>
<span class="line"><span>#1.1 判断脚本依赖命令是否存在</span></span>
<span class="line"><span>[ ! -x /usr/bin/curl ]&amp;&amp;echo &quot;curl: not found command&quot;&amp;&amp;exit 1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#1.2 访问一次URL</span></span>
<span class="line"><span>curl -I $1 &amp;&gt; $temp_file</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>#2、从输出中截取状态码</span></span>
<span class="line"><span>url_status=\`grep &quot;HTTP/1.1&quot; $temp_file|cut -d &quot; &quot; -f2\`</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#2.1如果取值失败直接报错(测试发现当无法访问URL时会在第三步中报比较错误，所以这里取不到值就不往下走了)</span></span>
<span class="line"><span>[ -z &quot;$url_status&quot; ]&amp;&amp;echo -e &quot;\\033[31mstatus:NULL\\033[0m&quot;&amp;&amp;exit 1</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>#3、判断状态码是否和预设的一致</span></span>
<span class="line"><span>    #3.1 一致  输出绿色字体 &quot;status:200&quot;</span></span>
<span class="line"><span>    #3.2 不一致 输出红色字体 &quot;status:XXX&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if [ $init_url_status -eq $url_status ];then</span></span>
<span class="line"><span>    echo -e &quot;\\033[32mstatus:$url_status\\033[0m&quot;</span></span>
<span class="line"><span>else</span></span>
<span class="line"><span>    echo -e &quot;\\033[31mstatus:$url_status\\033[0m&quot;</span></span>
<span class="line"><span>fi</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#4、删除临时文件</span></span>
<span class="line"><span>rm -f $temp_file</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="案例思考" tabindex="-1"><a class="header-anchor" href="#案例思考"><span>案例思考</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>页面监控方法(监控页面字符串或全页内容)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,15),p=[l];function c(d,t){return a(),n("div",null,p)}const v=s(i,[["render",c],["__file","shell脚本案例-监控接口.html.vue"]]),m=JSON.parse('{"path":"/demo/back-ends/Linux/Shell%E8%84%9A%E6%9C%AC/shell%E8%84%9A%E6%9C%AC%E6%A1%88%E4%BE%8B-%E7%9B%91%E6%8E%A7%E6%8E%A5%E5%8F%A3.html","title":"shell脚本案例-监控接口","lang":"en-US","frontmatter":{"title":"shell脚本案例-监控接口","icon":"code","category":"shell","order":29,"description":"案例需求 URL监控脚本，对某个URL进行监控，返回值为200则代表成功访问。 脚本应用场景： WEB站点监控 解决问题 URL监控 页面监控 脚本思路 1、使用curl访问一次URL，并将输出保存 2、访问输出文件，获取返回值 3、判断返回值是否和初始预设的返回值相等，并对应输出 实现代码 案例思考","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/demo/back-ends/Linux/Shell%E8%84%9A%E6%9C%AC/shell%E8%84%9A%E6%9C%AC%E6%A1%88%E4%BE%8B-%E7%9B%91%E6%8E%A7%E6%8E%A5%E5%8F%A3.html"}],["meta",{"property":"og:site_name","content":"Utopia"}],["meta",{"property":"og:title","content":"shell脚本案例-监控接口"}],["meta",{"property":"og:description","content":"案例需求 URL监控脚本，对某个URL进行监控，返回值为200则代表成功访问。 脚本应用场景： WEB站点监控 解决问题 URL监控 页面监控 脚本思路 1、使用curl访问一次URL，并将输出保存 2、访问输出文件，获取返回值 3、判断返回值是否和初始预设的返回值相等，并对应输出 实现代码 案例思考"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-09-21T02:46:20.000Z"}],["meta",{"property":"article:author","content":"GXL"}],["meta",{"property":"article:modified_time","content":"2024-09-21T02:46:20.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"shell脚本案例-监控接口\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-09-21T02:46:20.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"GXL\\",\\"url\\":\\"https://www.cnblogs.com/feel-myself\\",\\"email\\":\\"gaoxiaoliang123@126.com\\"}]}"]]},"headers":[{"level":2,"title":"案例需求","slug":"案例需求","link":"#案例需求","children":[]},{"level":2,"title":"脚本应用场景：","slug":"脚本应用场景","link":"#脚本应用场景","children":[]},{"level":2,"title":"解决问题","slug":"解决问题","link":"#解决问题","children":[]},{"level":2,"title":"脚本思路","slug":"脚本思路","link":"#脚本思路","children":[]},{"level":2,"title":"实现代码","slug":"实现代码","link":"#实现代码","children":[]},{"level":2,"title":"案例思考","slug":"案例思考","link":"#案例思考","children":[]}],"git":{"createdTime":1726886780000,"updatedTime":1726886780000,"contributors":[{"name":"udo-bit","email":"enote_gxl@163.com","commits":1}]},"readingTime":{"minutes":1.38,"words":415},"filePathRelative":"demo/back-ends/Linux/Shell脚本/shell脚本案例-监控接口.md","localizedDate":"September 21, 2024","excerpt":"<h2>案例需求</h2>\\n<p>URL监控脚本，对某个URL进行监控，返回值为200则代表成功访问。</p>\\n<h2>脚本应用场景：</h2>\\n<p>WEB站点监控</p>\\n<h2>解决问题</h2>\\n<p>URL监控</p>\\n<p>页面监控</p>\\n<h2>脚本思路</h2>\\n<p>1、使用curl访问一次URL，并将输出保存</p>\\n<p>2、访问输出文件，获取返回值</p>\\n<p>3、判断返回值是否和初始预设的返回值相等，并对应输出</p>\\n<h2>实现代码</h2>\\n<div class=\\"language- line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"\\" data-title=\\"\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span>#!/bin/bash</span></span>\\n<span class=\\"line\\"><span># </span></span>\\n<span class=\\"line\\"><span>#Author: www.zutuanxue.com</span></span>\\n<span class=\\"line\\"><span>#Created Time: </span></span>\\n<span class=\\"line\\"><span>#Release: </span></span>\\n<span class=\\"line\\"><span>#Description: URL监控脚本</span></span>\\n<span class=\\"line\\"><span>#监控阈值可以是: 状态码、页面字符串、页面所有内容</span></span>\\n<span class=\\"line\\"><span>#本例以状态码为例</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>#variables</span></span>\\n<span class=\\"line\\"><span>init_url_status=200</span></span>\\n<span class=\\"line\\"><span>temp_file=`mktemp /tmp/check_url.XXX`</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>#help</span></span>\\n<span class=\\"line\\"><span>if [ -z \\"$1\\" ]||[ \\"$1\\" == \\"--help\\" ];then</span></span>\\n<span class=\\"line\\"><span>   echo \\"$0 url\\"</span></span>\\n<span class=\\"line\\"><span>   echo \\"--help: 打印该帮助\\"</span></span>\\n<span class=\\"line\\"><span>fi</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>#如果用户没有传参则退出</span></span>\\n<span class=\\"line\\"><span>[ $# -lt 1 ]&amp;&amp;exit 1</span></span>\\n<span class=\\"line\\"><span>#main</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>#1、使用curl命令访问一次URL</span></span>\\n<span class=\\"line\\"><span>#1.1 判断脚本依赖命令是否存在</span></span>\\n<span class=\\"line\\"><span>[ ! -x /usr/bin/curl ]&amp;&amp;echo \\"curl: not found command\\"&amp;&amp;exit 1</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>#1.2 访问一次URL</span></span>\\n<span class=\\"line\\"><span>curl -I $1 &amp;&gt; $temp_file</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>#2、从输出中截取状态码</span></span>\\n<span class=\\"line\\"><span>url_status=`grep \\"HTTP/1.1\\" $temp_file|cut -d \\" \\" -f2`</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>#2.1如果取值失败直接报错(测试发现当无法访问URL时会在第三步中报比较错误，所以这里取不到值就不往下走了)</span></span>\\n<span class=\\"line\\"><span>[ -z \\"$url_status\\" ]&amp;&amp;echo -e \\"\\\\033[31mstatus:NULL\\\\033[0m\\"&amp;&amp;exit 1</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>#3、判断状态码是否和预设的一致</span></span>\\n<span class=\\"line\\"><span>    #3.1 一致  输出绿色字体 \\"status:200\\"</span></span>\\n<span class=\\"line\\"><span>    #3.2 不一致 输出红色字体 \\"status:XXX\\"</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>if [ $init_url_status -eq $url_status ];then</span></span>\\n<span class=\\"line\\"><span>    echo -e \\"\\\\033[32mstatus:$url_status\\\\033[0m\\"</span></span>\\n<span class=\\"line\\"><span>else</span></span>\\n<span class=\\"line\\"><span>    echo -e \\"\\\\033[31mstatus:$url_status\\\\033[0m\\"</span></span>\\n<span class=\\"line\\"><span>fi</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>#4、删除临时文件</span></span>\\n<span class=\\"line\\"><span>rm -f $temp_file</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{v as comp,m as data};
